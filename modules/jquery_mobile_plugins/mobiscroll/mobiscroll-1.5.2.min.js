(function(d){function z(K,h,G){var I=this,M=G,J,L,l,H={},m=false;this.settings=M;this.values=null;this.val=null;this.temp=null;this.setDefaults=function(N){d.extend(i,N)};this.enable=function(){M.disabled=false;if(d(K).is(":input")){d(K).prop("disabled",false)}};this.scroll=function(P,S,R,T,N){P.attr("style",(R?(w+"-transition:all "+R.toFixed(1)+"s ease-out;"):"")+(k?(w+"-transform:translate3d(0,"+(S*y)+"px,0);"):("top:"+(S*y)+"px;")));function Q(V,U,X,W){return X*Math.sin(V/W*(Math.PI/2))+U}if(R){var O=0;clearInterval(H[N]);H[N]=setInterval(function(){O+=0.1;P.data("pos",Math.round(Q(O,T,S-T,R)));if(O>=R){clearInterval(H[N]);P.data("pos",S)}},100)}else{P.data("pos",S)}};this.disable=function(){M.disabled=true;if(d(K).is(":input")){d(K).prop("disabled",true)}};this.formatDate=function(W,O,P){if(!O){return null}var X=d.extend({},this.settings,P),U=function(Y){var Z=0;while(S+1<W.length&&W.charAt(S+1)==Y){Z++;S++}return Z},R=function(Z,aa,Y){var ab=""+aa;if(U(Z)){while(ab.length<Y){ab="0"+ab}}return ab},Q=function(Y,ab,aa,Z){return(U(Y)?Z[ab]:aa[ab])},N="",V=false;for(var S=0;S<W.length;S++){if(V){if(W.charAt(S)=="'"&&!U("'")){V=false}else{N+=W.charAt(S)}}else{switch(W.charAt(S)){case"d":N+=R("d",O.getDate(),2);break;case"D":N+=Q("D",O.getDay(),X.dayNamesShort,X.dayNames);break;case"o":N+=R("o",(O.getTime()-new Date(O.getFullYear(),0,0).getTime())/86400000,3);break;case"m":N+=R("m",O.getMonth()+1,2);break;case"M":N+=Q("M",O.getMonth(),X.monthNamesShort,X.monthNames);break;case"y":N+=(U("y")?O.getFullYear():(O.getYear()%100<10?"0":"")+O.getYear()%100);break;case"h":var T=O.getHours();N+=R("h",(T>12?(T-12):(T==0?12:T)),2);break;case"H":N+=R("H",O.getHours(),2);break;case"i":N+=R("i",O.getMinutes(),2);break;case"s":N+=R("s",O.getSeconds(),2);break;case"a":N+=O.getHours()>11?"pm":"am";break;case"A":N+=O.getHours()>11?"PM":"AM";break;case"'":if(U("'")){N+="'"}else{V=true}break;default:N+=W.charAt(S)}}}return N};this.parseDate=function(ad,W,af){var R=new Date();if(!ad||!W){return R}W=(typeof W=="object"?W.toString():W+"");var T=d.extend({},this.settings,af),O=R.getFullYear(),ah=R.getMonth(),ab=R.getDate(),Q=-1,ae=R.getHours(),X=R.getMinutes(),P=R.getSeconds(),U=-1,aa=false,V=function(aj){var ak=(N+1<ad.length&&ad.charAt(N+1)==aj);if(ak){N++}return ak},ai=function(ak){V(ak);var al=(ak=="@"?14:(ak=="!"?20:(ak=="y"?4:(ak=="o"?3:2))));var am=new RegExp("^\\d{1,"+al+"}");var aj=W.substr(ac).match(am);if(!aj){throw"Missing number at position "+ac}ac+=aj[0].length;return parseInt(aj[0],10)},S=function(ak,am,aj){var an=(V(ak)?aj:am);for(var al=0;al<an.length;al++){if(W.substr(ac,an[al].length).toLowerCase()==an[al].toLowerCase()){ac+=an[al].length;return al+1}}throw"Unknown name at position "+ac},Z=function(){if(W.charAt(ac)!=ad.charAt(N)){throw"Unexpected literal at position "+ac}ac++},ac=0;for(var N=0;N<ad.length;N++){if(aa){if(ad.charAt(N)=="'"&&!V("'")){aa=false}else{Z()}}else{switch(ad.charAt(N)){case"d":ab=ai("d");break;case"D":S("D",T.dayNamesShort,T.dayNames);break;case"o":Q=ai("o");break;case"m":ah=ai("m");break;case"M":ah=S("M",T.monthNamesShort,T.monthNames);break;case"y":O=ai("y");break;case"H":ae=ai("H");break;case"h":ae=ai("h");break;case"i":X=ai("i");break;case"s":P=ai("s");break;case"a":U=S("a",["am","pm"],["am","pm"])-1;break;case"A":U=S("A",["am","pm"],["am","pm"])-1;break;case"'":if(V("'")){Z()}else{aa=true}break;default:Z()}}}if(O<100){O+=new Date().getFullYear()-new Date().getFullYear()%100+(O<=T.shortYearCutoff?0:-100)}if(Q>-1){ah=1;ab=Q;do{var Y=32-new Date(O,ah-1,32).getDate();if(ab<=Y){break}ah++;ab-=Y}while(true)}ae=(U==-1)?ae:((U&&ae<12)?(ae+12):(!U&&ae==12?0:ae));var ag=new Date(O,ah-1,ab,ae,X,P);if(ag.getFullYear()!=O||ag.getMonth()+1!=ah||ag.getDate()!=ab){throw"Invalid date"}return ag};this.setValue=function(O){if(O==undefined){O=true}var N=this.formatResult();this.val=N;this.values=this.temp.slice(0);if(O&&d(K).is(":input")){d(K).val(N).change()}};this.getDate=function(){var O=this.values;if(M.preset=="date"){return new Date(O[J],O[L],O[l])}if(M.preset=="time"){var N=(M.ampm)?((O[M.seconds?3:2]=="PM"&&(O[0]-0)<12)?(O[0]-0+12):(O[M.seconds?3:2]=="AM"&&(O[0]==12)?0:O[0])):O[0];return new Date(1970,0,1,N,O[1],M.seconds?O[2]:null)}if(M.preset=="datetime"){var N=(M.ampm)?((O[M.seconds?6:5]=="PM"&&(O[3]-0)<12)?(O[3]-0+12):(O[M.seconds?6:5]=="AM"&&(O[3]==12)?0:O[3])):O[3];return new Date(O[J],O[L],O[l],N,O[4],M.seconds?O[5]:null)}};this.setDate=function(P,O){if(M.preset.match(/date/i)){this.temp[J]=P.getFullYear();this.temp[L]=P.getMonth();this.temp[l]=P.getDate()}if(M.preset=="time"){var N=P.getHours();this.temp[0]=(M.ampm)?(N>12?(N-12):(N==0?12:N)):N;this.temp[1]=P.getMinutes();if(M.seconds){this.temp[2]=P.getSeconds()}if(M.ampm){this.temp[M.seconds?3:2]=N>11?"PM":"AM"}}if(M.preset=="datetime"){var N=P.getHours();this.temp[3]=(M.ampm)?(N>12?(N-12):(N==0?12:N)):N;this.temp[4]=P.getMinutes();if(M.seconds){this.temp[5]=P.getSeconds()}if(M.ampm){this.temp[M.seconds?6:5]=N>11?"PM":"AM"}}this.setValue(O)};this.parseValue=function(R){if(this.preset){var N=[];if(M.preset=="date"){try{var Q=this.parseDate(M.dateFormat,R,M)}catch(P){var Q=new Date()}N[J]=Q.getFullYear();N[L]=Q.getMonth();N[l]=Q.getDate()}else{if(M.preset=="time"){try{var Q=this.parseDate(M.timeFormat,R,M)}catch(P){var Q=new Date()}var O=Q.getHours();N[0]=(M.ampm)?(O>12?(O-12):(O==0?12:O)):O;N[1]=Q.getMinutes();if(M.seconds){N[2]=Q.getSeconds()}if(M.ampm){N[M.seconds?3:2]=O>11?"PM":"AM"}}else{if(M.preset=="datetime"){try{var Q=this.parseDate(M.dateFormat+" "+M.timeFormat,R,M)}catch(P){var Q=new Date()}var O=Q.getHours();N[J]=Q.getFullYear();N[L]=Q.getMonth();N[l]=Q.getDate();N[3]=(M.ampm)?(O>12?(O-12):(O==0?12:O)):O;N[4]=Q.getMinutes();if(M.seconds){N[5]=Q.getSeconds()}if(M.ampm){N[M.seconds?6:5]=O>11?"PM":"AM"}}}}return N}return M.parseValue(R,this)};this.formatResult=function(){var O=this.temp;if(this.preset){if(M.preset=="date"){return this.formatDate(M.dateFormat,new Date(O[J],O[L],O[l]),M)}else{if(M.preset=="datetime"){var N=(M.ampm)?((O[M.seconds?6:5]=="PM"&&(O[3]-0)<12)?(O[3]-0+12):(O[M.seconds?6:5]=="AM"&&(O[3]==12)?0:O[3])):O[3];return this.formatDate(M.dateFormat+" "+M.timeFormat,new Date(O[J],O[L],O[l],N,O[4],M.seconds?O[5]:null),M)}else{if(M.preset=="time"){var N=(M.ampm)?((O[M.seconds?3:2]=="PM"&&(O[0]-0)<12)?(O[0]-0+12):(O[M.seconds?3:2]=="AM"&&(O[0]==12)?0:O[0])):O[0];return this.formatDate(M.timeFormat,new Date(1970,0,1,N,O[1],M.seconds?O[2]:null),M)}}}}return M.formatResult(O)};this.validate=function(O){if(this.preset&&M.preset.match(/date/i)&&((O==J)||(O==L)||(O==-1))){var P=32-new Date(this.temp[J],this.temp[L],32).getDate()-1;var N=d("ul:eq("+l+")",h);d("li",N).show();d("li:gt("+P+")",N).hide();if(this.temp[l]>P){this.scroll(N,s-P-1);this.temp[l]=d("li:eq("+P+")",N).data("val")}}else{M.validate(O)}};this.hide=function(){if(M.onClose(this.val,this)===false){return false}d(".dwtd").prop("disabled",false).removeClass("dwtd");d(K).blur();h.hide();n.hide();m=false;if(this.preset){M.wheels=null}d(window).unbind("resize.dw")};this.show=function(){if(M.disabled||m){return false}M.beforeShow(K,this);y=M.height;s=Math.round(M.rows/2);a=this;this.init();if(this.preset){M.wheels=new Array();if(M.preset.match(/date/i)){var N={};for(var P=0;P<3;P++){if(P==J){N[M.yearText]={};for(var S=M.startYear;S<=M.endYear;S++){N[M.yearText][S]=M.dateOrder.search(/yy/i)<0?S.toString().substr(2,2):S.toString()}}else{if(P==L){N[M.monthText]={};for(var S=0;S<12;S++){N[M.monthText][S]=(M.dateOrder.search(/MM/)<0?(M.dateOrder.search(/M/)<0?(M.dateOrder.search(/mm/)<0?(S+1):(S<9)?("0"+(S+1)):(S+1)):M.monthNamesShort[S]):M.monthNames[S])}}else{if(P==l){N[M.dayText]={};for(var S=1;S<32;S++){N[M.dayText][S]=M.dateOrder.search(/dd/i)<0?S:(S<10)?("0"+S):S}}}}}M.wheels.push(N)}if(M.preset.match(/time/i)){M.stepHour=(M.stepHour<1)?1:parseInt(M.stepHour);M.stepMinute=(M.stepMinute<1)?1:parseInt(M.stepMinute);M.stepSecond=(M.stepSecond<1)?1:parseInt(M.stepSecond);var N={};N[M.hourText]={};for(var S=(M.ampm?1:0);S<(M.ampm?13:24);S+=M.stepHour){N[M.hourText][S]=(S<10)?("0"+S):S}N[M.minuteText]={};for(var S=0;S<60;S+=M.stepMinute){N[M.minuteText][S]=(S<10)?("0"+S):S}if(M.seconds){N[M.secText]={};for(var S=0;S<60;S+=M.stepSecond){N[M.secText][S]=(S<10)?("0"+S):S}}if(M.ampm){N[M.ampmText]={};N[M.ampmText]["AM"]="AM";N[M.ampmText]["PM"]="PM"}M.wheels.push(N)}}d(".dwc",h).remove();for(var S=0;S<M.wheels.length;S++){var O=d('<div class="dwc'+(M.mode=="clickpick"?" dwpm":"")+'"><div class="dwwc dwrc"><div class="clear" style="clear:both;"></div></div>').insertBefore(d(".dwbc",h));for(var R in M.wheels[S]){var T=d(".dwwc .clear",O);var N=d('<div class="dwwl dwrc">'+(M.mode=="clickpick"?'<div class="dwwb dwwbp">+</div><div class="dwwb dwwbm">&ndash;</div>':"")+'<div class="dwl">'+R+'</div><div class="dww dwrc"><ul></ul><div class="dwwo"></div></div><div class="dwwol"></div></div>').insertBefore(T);for(var Q in M.wheels[S][R]){d('<li class="val_'+Q+'">'+M.wheels[S][R][Q]+"</li>").data("val",Q).appendTo(d("ul",N))}}}d(".dww ul",h).each(function(V){var U=d("li",this).index(d("li.val_"+I.temp[V],this));while((U<0)&&(--I.temp[V]>=0)){U=d("li",this).index(d("li.val_"+I.temp[V],this))}I.scroll(d(this),s-(U<0?0:U)-1)});d(".dwv",h).html(this.formatResult());I.validate(-1);d("#dw_set",h).text(M.setText).unbind().bind("click",function(U){I.setValue();M.onSelect(I.val,a);I.hide();return false});d("#dw_cancel",h).text(M.cancelText).unbind().bind("click",function(U){M.onCancel(I.val,a);I.hide();return false});d(":input:not(:disabled)").addClass("dwtd");d(":input").prop("disabled",true);n.show();h.attr("class","dw "+M.theme).show();m=true;d(".dww, .dwwl",h).height(M.rows*y);d(".dww",h).each(function(){d(this).width(d(this).parent().width()<M.width?M.width:d(this).parent().width())});d(".dwbc a",h).attr("class",M.btnClass);d(".dww li, .dwwb",h).css({height:y,lineHeight:y+"px"});d(".dwwc",h).each(function(){var U=0;d(".dwwl",this).each(function(){U+=d(this).outerWidth(true)});d(this).width(U)});d(".dwc",h).each(function(){d(this).width(d(".dwwc",this).outerWidth(true))});this.pos();d(window).bind("resize.dw",function(){I.pos()})};this.pos=function(){var N=0,Q=0,T=d(window).width(),P=d(window).height(),R=d(window).scrollTop(),O,S;d(".dwc",h).each(function(){O=d(this).outerWidth(true);N+=O;Q=(O>Q)?O:Q});O=N>T?Q:N;h.width(O);O=h.outerWidth();S=h.outerHeight();h.css({left:(T-O)/2,top:R+(P-S)/2});n.height(0);n.height(d(document).height())};this.init=function(){var N=M.dateOrder.search(/y/i),O=M.dateOrder.search(/m/i),P=M.dateOrder.search(/d/i);J=(N<O)?(N<P?0:1):(N<P?1:2);L=(O<N)?(O<P?0:1):(O<P?1:2);l=(P<N)?(P<O?0:1):(P<O?1:2);this.preset=(M.wheels===null);this.temp=(d(K).is("input")||this.values===null)?this.parseValue(d(K).val()?d(K).val():""):this.values.slice(0);this.setValue(false)};this.init();if(d(K).is(":input")&&M.showOnFocus){d(K).data("dwro",d(K).prop("readonly")).prop("readonly",true)}d(K).addClass("scroller").unbind("focus.dw").bind("focus.dw",function(N){if(M.showOnFocus){I.show()}})}function F(l){for(var h in l){if(D[l[h]]!==undefined){return true}}return false}function b(){var h=["Webkit","Moz","O","ms"];for(var l in h){if(F([h[l]+"Transform"])){return"-"+h[l].toLowerCase()}}return""}var o,n,y,s,u,a,j={},C=new Date(),x=C.getTime(),r=false,E=null,e,t,p,c,f,D=document.createElement(D).style,k=F(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"])&&"webkitPerspective" in document.documentElement.style,w=b(),g=("ontouchstart" in window),v=g?"touchstart":"mousedown",B=g?"touchmove":"mousemove",q=g?"touchend":"mouseup",i={width:80,height:40,rows:3,disabled:false,showOnFocus:true,wheels:null,theme:"",mode:"scroller",preset:"date",dateFormat:"mm/dd/yy",dateOrder:"mmddy",ampm:true,seconds:false,timeFormat:"hh:ii A",startYear:C.getFullYear()-100,endYear:C.getFullYear()+1,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortYearCutoff:"+10",monthText:"Month",dayText:"Day",yearText:"Year",hourText:"Hours",minuteText:"Minutes",secText:"Seconds",ampmText:"&nbsp;",setText:"Set",cancelText:"Cancel",btnClass:"dwb",stepHour:1,stepMinute:1,stepSecond:1,beforeShow:function(){},onClose:function(){},onSelect:function(){},onCancel:function(){},formatResult:function(m){var h="";for(var l=0;l<m.length;l++){h+=(l>0?" ":"")+m[l]}return h},parseValue:function(m,I){var L=I.settings.wheels,J=m.split(" "),h=[],K=0;for(var H=0;H<L.length;H++){for(var G in L[H]){K++;for(var M in L[H][G]){h.push(M);break}}}return J.length==K?J:h},validate:function(){return true}},A={init:function(L){if(L===undefined){L={}}var H={};if(L.theme=="ios"){H.dateOrder="MMdyy";H.rows=5;H.height=30;H.width=55}if(L.mode=="clickpick"){H.height=50;H.rows=3}var l=d.extend({},i,H,L),h=false,J=false;if(d(".dw").length){n=d(".dwo");o=d(".dw")}else{n=d('<div class="dwo"></div>').hide().appendTo("body");o=d('<div class="dw"><div class="dwv">&nbsp;</div><div class="dwbc" style="clear:both;"><span class="dwbw dwb-s"><a id="dw_set" href="#"></a></span><span class="dwbw dwb-c"><a id="dw_cancel" href="#"></a></span></div></div>');o.hide().appendTo("body");function K(M){return g?M.originalEvent.changedTouches[0].pageY:M.pageY}function G(N,P,O,Q){var M=d("ul",o).index(N);P=P>(s-1)?(s-1):P;P=P<(s-u)?(s-u):P;a.scroll(N,P,O?(P==Q?0.1:Math.abs((P-Q)*0.1)):0,Q,M);a.temp[M]=d("li:eq("+(s-1-P)+")",N).data("val");a.validate(M);d(".dwv",o).html(a.formatResult())}function I(M){if(h){var N=M.data("pos"),O=N-1;O=O<(s-u)?(s-1):O;G(M,O)}else{clearInterval(h)}}function m(M){if(J){var N=M.data("pos"),O=N+1;O=O>(s-1)?(s-u):O;G(M,O)}else{clearInterval(J)}}d(document).bind(B,function(M){if(r){M.preventDefault();t=K(M);var N=f+(t-e)/y;N=N>(s-1+1)?(s-1+1):N;N=N<(s-u-1)?(s-u-1):N;a.scroll(E,N)}});d(document).bind(q,function(N){if(r){N.preventDefault();var M=new Date()-p;var P=f+(t-e)/y;P=P>(s-1+1)?(s-1+1):P;P=P<(s-u-1)?(s-u-1):P;var O=t-e;G(E,Math.round(f+O/y),true,Math.round(P));r=false;E=null}clearInterval(h);clearInterval(J);h=false;J=false;d(".dwb-a").removeClass("dwb-a")});o.delegate(".dwwl","DOMMouseScroll mousewheel",function(O){O.preventDefault();var Q=O.wheelDelta?(O.wheelDelta/120):(O.detail?(-O.detail/3):0),M=d("ul",this),N=M.data("pos"),P=Math.round(N+Q);u=d("li:visible",M).length;G(M,P)}).delegate(".dwb, .dwwb",v,function(M){d(this).addClass("dwb-a")}).delegate(".dwwbp",v,function(N){N.preventDefault();var M=d(this).closest(".dwwl").find("ul");u=d("li:visible",M).length;clearInterval(h);h=setInterval(function(){I(M)},200);I(M)}).delegate(".dwwbm",v,function(N){N.preventDefault();var M=d(this).closest(".dwwl").find("ul");u=d("li:visible",M).length;clearInterval(J);J=setInterval(function(){m(M)},200);m(M)}).delegate(".dwwl",v,function(M){if(!r&&a.settings.mode=="scroller"){M.preventDefault();r=true;E=d("ul",this);f=E.data("pos");u=d("li:visible",E).length;e=K(M);p=new Date();t=e;a.scroll(E,f)}})}return this.each(function(){if(!this.id){x+=1;this.id="scoller"+x}j[this.id]=new z(this,o,l)})},enable:function(){return this.each(function(){if(j[this.id]){j[this.id].enable()}})},disable:function(){return this.each(function(){if(j[this.id]){j[this.id].disable()}})},isDisabled:function(){if(j[this[0].id]){return j[this[0].id].settings.disabled}},option:function(h,l){return this.each(function(){if(j[this.id]){if(typeof h==="object"){d.extend(j[this.id].settings,h)}else{j[this.id].settings[h]=l}j[this.id].init()}})},setValue:function(l,h){if(h==undefined){h=false}return this.each(function(){if(j[this.id]){j[this.id].temp=l;j[this.id].setValue(l,h)}})},getValue:function(){if(j[this[0].id]){return j[this[0].id].values}},setDate:function(l,h){if(h==undefined){h=false}return this.each(function(){if(j[this.id]){j[this.id].setDate(l,h)}})},getDate:function(){if(j[this[0].id]){return j[this[0].id].getDate()}},show:function(){if(j[this[0].id]){return j[this[0].id].show()}},hide:function(){return this.each(function(){if(j[this.id]){j[this.id].hide()}})},destroy:function(){return this.each(function(){if(j[this.id]){d(this).unbind("focus.dw").removeClass("scroller");if(d(this).is(":input")){d(this).prop("readonly",d(this).data("dwro"))}delete j[this.id]}})}};d.fn.scroller=function(h){if(A[h]){return A[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof h==="object"||!h){return A.init.apply(this,arguments)}else{d.error("Unknown method")}}};d.scroller=new z(null,null,i)})(jQuery);
